<div class="table-responsive">
  <table
    class="table align-middle table-bordered text-center table-hover table-active"
    style="width: 3200px"
  >
    <colgroup>
      <col span="1" style="width: 3%" />
      <col span="1" style="width: 10%" />
      <col span="11" style="width: 3%" />
      <% if(userRole == "opd") { %>
        <col span="2" style="width: 1%" />
      <% } %>
    </colgroup>
    <thead class="table-primary align-middle">
      <tr>
        <th rowspan="3" scope="col">No Rek</th>
        <th rowspan="3" scope="col">Program/Kegiatan</th>
        <th rowspan="3" scope="col">Jumlah Pagu Anggaran</th>
        <th colspan="10" scope="col">Dana Bagi Hasil</th>
        <% if(userRole == "opd") { %>
          <th colspan="2" rowspan="2" scope="col">#</th>
        <% } %>
      </tr>
      <tr>
        <th colspan="2" scope="col">
          Pendapatan Bagi Hasil Pajak Kendaraan Bermotor (PKB)
        </th>
        <th colspan="2" scope="col">
          Pendapatan Bagi Hasil Bea Balik Nama Kendaraan Bermotor (BBNKB)
        </th>
        <th colspan="2" scope="col">
          Pendapatan Bagi Hasil Pajak Bahan Bakar Kendaraan Bermotor (PBBKB)
        </th>
        <th colspan="2" scope="col">
          Pendapatan Bagi Hasil Pajak Air Permukaan (PAP)
        </th>
        <th colspan="2" scope="col">Pendapatan Bagi Hasil Pajak Rokok</th>
      </tr>
      <tr>
        <th scope="col">Anggaran</th>
        <th scope="col">Realisasi</th>
        <th scope="col">Anggaran</th>
        <th scope="col">Realisasi</th>
        <th scope="col">Anggaran</th>
        <th scope="col">Realisasi</th>
        <th scope="col">Anggaran</th>
        <th scope="col">Realisasi</th>
        <th scope="col">Anggaran</th>
        <th scope="col">Realisasi</th>
        <% if(userRole == "opd") { %>  
          <th scope="col">Edit</th>
          <th scope="col">Delete</th>
        <% } %>
      </tr>
    </thead>
    <tbody class="table-light table-group-divider align-middle"> 
      <% const dbhRealizationData = dbhRealizationOpd.find(item => item.reportingId == currentReporting?._id.toString())?.data ?? []; %>                            
      <% const totalDataInstitution = dbhRealizationData.find(item => item.parameter == "Lembaga"); %>                            
      <% for(let data of dbhRealizationData) { %> 
        <% if(data.parameter !== "Lembaga") { %>
          <input type="hidden" name="dbhId" value="<%= data._id %>">                                    
          <tr id="<%= data._id %>" class="<%= data.parameter === 'Program' ? 'table-success' : '' %>">
            <th scope="row"><%= data.noRek %></th>
            <% if(data.parameter === "Program") { %>
              <td class="text-uppercase fw-semibold"><%= data.name %></td>              
            <% }  else { %>
              <td class="px-3 text-start"><%= data.name %></td>              
            <% } %>
            <td><%= data.pagu %></td>
            <td><%= data.dbh.pkb[0] %></td>
            <td><%= data.dbh.pkb[1] %></td>
            <td><%= data.dbh.bbnkb[0] %></td>
            <td><%= data.dbh.bbnkb[1] %></td>
            <td><%= data.dbh.pbbkb[0] %></td>
            <td><%= data.dbh.pbbkb[1] %></td>
            <td><%= data.dbh.pap[0] %></td>
            <td><%= data.dbh.pap[1] %></td>
            <td><%= data.dbh.pajakRokok[0] %></td>
            <td><%= data.dbh.pajakRokok[1] %></td> 
            <% if(userRole == "opd") { %>
              <td id="edit-btn"><i class="bi bi-pencil"></i></td>
              <td id="delete-btn"><i class="bi bi-trash3"></i></td>
            <% } %>
          </tr>                
        <% } %>
      <% } %>
      <tr id="sub-total">
        <td></td>
        <th scope="row">Sub Total</th>
        <td><%= totalDataInstitution.pagu %></td>
        <td><%= totalDataInstitution.dbh.pkb[0] %></td>
        <td><%= totalDataInstitution.dbh.pkb[1] %></td>
        <td><%= totalDataInstitution.dbh.bbnkb[0] %></td>
        <td><%= totalDataInstitution.dbh.bbnkb[1] %></td>
        <td><%= totalDataInstitution.dbh.pbbkb[0] %></td>
        <td><%= totalDataInstitution.dbh.pbbkb[1] %></td>
        <td><%= totalDataInstitution.dbh.pap[0] %></td>
        <td><%= totalDataInstitution.dbh.pap[1] %></td>
        <td><%= totalDataInstitution.dbh.pajakRokok[0] %></td>
        <td><%= totalDataInstitution.dbh.pajakRokok[1] %></td> 
        <% if(userRole == "opd") { %>
          <td colspan="2"></td>
        <% } %>          
      </tr>                
      <% if(userRole == "admin") { %>             
        <tr>
          <td></td>
          <th scope="row" class="text-danger">TOTAL</th>
          <td><%= currentReporting.totalInstitutionDbh.pagu %></td>
          <td><%= currentReporting.totalInstitutionDbh.pkb[0] %></td>
          <td><%= currentReporting.totalInstitutionDbh.pkb[1] %></td>
          <td><%= currentReporting.totalInstitutionDbh.bbnkb[0] %></td>
          <td><%= currentReporting.totalInstitutionDbh.bbnkb[1] %></td>
          <td><%= currentReporting.totalInstitutionDbh.pbbkb[0] %></td>
          <td><%= currentReporting.totalInstitutionDbh.pbbkb[1] %></td>
          <td><%= currentReporting.totalInstitutionDbh.pap[0] %></td>
          <td><%= currentReporting.totalInstitutionDbh.pap[1] %></td>
          <td><%= currentReporting.totalInstitutionDbh.pajakRokok[0] %></td>
          <td><%= currentReporting.totalInstitutionDbh.pajakRokok[1] %></td>          
        </tr>          
        <tr>
          <td></td>
          <th scope="row" class="text-danger">DANA DBH PROVINSI</th>
          <td><%= currentReporting.totalDbhBudget %></td>            
          <td colspan="10"></td>
        </tr>          
        <tr>
          <td></td>
          <th scope="row" class="text-danger">REALISASI S/D BULAN JUNI (<%= currentReporting.period %>)</th>
          <td><%= currentReporting.totalDbhRealization %></td>            
          <td colspan="10"></td>
        </tr>                
      <% } %>
    </tbody>
  </table>
</div>
